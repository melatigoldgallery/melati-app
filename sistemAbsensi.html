<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <!-- jQuery first -->
    <script src="js/jquery-3.6.3.min.js"></script>
    <!-- Bootstrap CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/pages/absensi-modern.css" />
    <title>Sistem Absensi Staff - Melati Gold Shop</title>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <img src="img/Melati.jfif" alt="Logo" class="logo" />
          <h1 class="brand-name">Melati Gold</h1>
        </div>
        <div class="sidebar-menu">
          <ul>
            <li class="menu-item">
              <a href="dashboard.html">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
              </a>
            </li>
            <!-- Antrian dropdown menu -->
            <li class="menu-item has-submenu">
              <a href="#antrianSubmenu" data-bs-toggle="collapse" aria-expanded="false">
                <i class="fas fa-users-line"></i>
                <span>Antrian</span>
                <i class="fas fa-chevron-right submenu-icon"></i>
              </a>
              <ul class="collapse submenu" id="antrianSubmenu">
                <li><a href="admin.html">Admin Antrian</a></li>
                <li><a href="display.html">Display Antrian</a></li>
                <li><a href="analisis.html">Laporan Antrian</a></li>
              </ul>
            </li>
            <li class="menu-item">
              <a href="buyback.html">
                <i class="fas fa-exchange-alt"></i>
                <span>Buyback</span>
              </a>
            </li>
             <!-- Absensi dropdown menu -->
             <li class="menu-item has-submenu active">
              <a href="#">
                <i class="fas fa-user-clock"></i>
                <span>Absensi</span>
                <i class="fas fa-chevron-right submenu-icon"></i>
              </a>
              <ul class="submenu show">
                <li><a href="sistemAbsensi.html" class="active">Kehadiran</a></li>
                <li><a href="pengajuan-izin.html">Pengajuan Izin</a></li>
                <li><a href="tambah-pengguna.html">Tambah Pengguna</a></li>
                <li><a href="laporan-kehadiran.html">Laporan Kehadiran</a></li>
                <li><a href="laporan-izin.html">Laporan Izin</a></li>
              </ul>
            </li>
          </ul>
        </div>
        
        <div class="sidebar-footer">
          <p>Â© 2025 Melati Gold Shop</p>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Top Navigation -->
        <header class="top-nav">
          <div class="menu-toggle">
            <i class="fas fa-bars"></i>
          </div>
          <div class="nav-right">
            <div class="date-time">
              <div class="current-date" id="current-date"></div>
              <div class="current-time" id="current-time"></div>
            </div>
            <div class="user-profile dropdown">
              <div class="profile-img" data-bs-toggle="dropdown" aria-expanded="false">
                <span>K</span>
              </div>
              <ul class="dropdown-menu dropdown-menu-end">
                <!-- <li><a class="dropdown-item" href="#"><i class="fas fa-user"></i> Profil</a></li> -->
                <li><a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Pengaturan</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><button class="dropdown-item" id="logoutBtn" onclick="handleLogout()"><i class="fas fa-sign-out-alt"></i> Logout</button></li>
              </ul>
            </div>
          </div>
        </header>

        <!-- Page Content -->
        <div class="page-content">
          <div class="page-header">
            <h1>Sistem Absensi Staff</h1>
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="dashboard.html">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Absensi</li>
              </ol>
            </nav>
          </div>
          <div class="content-wrapper">
            <!-- Shift Info Card -->
            <div class="card shift-info-card">
              <div class="card-header">
                <h2><i class="fas fa-clock"></i> Informasi Jadwal Kerja</h2>
              </div>
              <div class="card-body">
                <div class="shift-info-container">
                  <div class="shift-item">
                    <div class="shift-icon morning">
                      <i class="fas fa-sun"></i>
                    </div>
                    <div class="shift-details">
                      <h3>Staff - Shift Pagi</h3>
                      <p><i class="fas fa-sign-in-alt"></i> Masuk: <strong>08:45</strong></p>
                      <p><i class="fas fa-sign-out-alt"></i> Pulang: <strong>16:30</strong></p>
                    </div>
                  </div>
                  <div class="shift-item">
                    <div class="shift-icon afternoon">
                      <i class="fas fa-moon"></i>
                    </div>
                    <div class="shift-details">
                      <h3>Staff - Shift Sore</h3>
                      <p><i class="fas fa-sign-in-alt"></i> Masuk: <strong>14:20</strong></p>
                      <p><i class="fas fa-sign-out-alt"></i> Pulang: <strong>Setelah Closing</strong></p>
                    </div>
                  </div>
                  <div class="shift-item">
                    <div class="shift-icon morning ob">
                      <i class="fas fa-broom"></i>
                    </div>
                    <div class="shift-details">
                      <h3>OB - Shift Pagi</h3>
                      <p><i class="fas fa-sign-in-alt"></i> Masuk: <strong>07:30</strong></p>
                      <p><i class="fas fa-sign-out-alt"></i> Pulang: <strong>15:30</strong></p>
                    </div>
                  </div>
                  <div class="shift-item">
                    <div class="shift-icon afternoon ob">
                      <i class="fas fa-broom"></i>
                    </div>
                    <div class="shift-details">
                      <h3>OB - Shift Sore</h3>
                      <p><i class="fas fa-sign-in-alt"></i> Masuk: <strong>13:30</strong></p>
                      <p><i class="fas fa-sign-out-alt"></i> Pulang: <strong>Setelah Closing</strong></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-cards">
              <div class="stat-card">
                <div class="stat-card-icon bg-primary">
                  <i class="fas fa-user-check"></i>
                </div>
                <div class="stat-card-info">
                  <h3 id="presentCount">0</h3>
                  <p>Hadir Hari Ini</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-card-icon bg-warning">
                  <i class="fas fa-user-clock"></i>
                </div>
                <div class="stat-card-info">
                  <h3 id="lateCount">0</h3>
                  <p>Terlambat</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-card-icon bg-danger">
                  <i class="fas fa-user-times"></i>
                </div>
                <div class="stat-card-info">
                  <h3 id="absentCount">0</h3>
                  <p>Tidak Hadir</p>
                </div>
              </div>
              
              <div class="stat-card">
                <div class="stat-card-icon bg-success">
                  <i class="fas fa-clipboard-list"></i>
                </div>
                <div class="stat-card-info">
                  <h3 id="leaveCount">0</h3>
                  <p>Izin</p>
                </div>
              </div>
            </div>

            <!-- Scanner Section -->
            <div class="card scanner-card">
              <div class="card-header">
                <h2><i class="fas fa-qrcode"></i> Scan Barcode Kehadiran</h2>
                <button class="btn btn-sm btn-outline-primary refresh-btn" id="refreshScanner">
                  <i class="fas fa-sync-alt"></i> Refresh
                </button>
              </div>
              <div class="card-body">
                <div class="scanner-container">
                  <div class="scan-type-selector mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="scanType" id="scanTypeIn" value="in" checked>
                      <label class="form-check-label" for="scanTypeIn">
                        <i class="fas fa-sign-in-alt"></i> Scan Masuk
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="scanType" id="scanTypeOut" value="out">
                      <label class="form-check-label" for="scanTypeOut">
                        <i class="fas fa-sign-out-alt"></i> Scan Pulang
                      </label>
                    </div>
                  </div>
                  
                  <div class="employee-type-selector mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="employeeType" id="employeeTypeAuto" value="auto" checked>
                      <label class="form-check-label" for="employeeTypeAuto">Deteksi Otomatis</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="employeeType" id="employeeTypeStaff" value="staff">
                      <label class="form-check-label" for="employeeTypeStaff">Staff</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="employeeType" id="employeeTypeOB" value="ob">
                      <label class="form-check-label" for="employeeTypeOB">Office Boy</label>
                    </div>
                  </div>
                  
                  <div class="shift-selector mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="shiftOption" id="shiftAuto" value="auto" checked>
                      <label class="form-check-label" for="shiftAuto">Deteksi Otomatis</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="shiftOption" id="shiftMorning" value="morning">
                      <label class="form-check-label" for="shiftMorning">Shift Pagi</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="shiftOption" id="shiftAfternoon" value="afternoon">
                      <label class="form-check-label" for="shiftAfternoon">Shift Sore</label>
                    </div>
                  </div>
                  
                  <div class="scanner-input-group">
                    <input 
                      type="text" 
                      id="barcodeInput" 
                      class="form-control" 
                      placeholder="Scan barcode disini..." 
                      autofocus 
                    />
                    <button class="btn btn-primary" id="manualSubmit">
                      <i class="fas fa-paper-plane"></i>
                    </button>
                  </div>
                  <div id="scanResult" class="scan-result"></div>
                </div>
                
                <div class="scanner-animation d-flex justify-content-center align-items-center">
                  <div class="scanner-line "></div>
                </div>
              </div>
            </div>

            <!-- Attendance List -->
            <div class="card attendance-card">
              <div class="card-header">
                <h2><i class="fas fa-clipboard-check"></i> Daftar Kehadiran Hari Ini</h2>
                <div class="card-actions">
                  <div class="dropdown me-2">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="employeeFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="fas fa-user-tag"></i> Tipe
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="employeeFilterDropdown">
                      <li><a class="dropdown-item" href="#" data-employee-filter="all">Semua</a></li>
                      <li><a class="dropdown-item" href="#" data-employee-filter="staff">Staff</a></li>
                      <li><a class="dropdown-item" href="#" data-employee-filter="ob">Office Boy</a></li>
                    </ul>
                  </div>
                  <div class="dropdown me-2">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="shiftFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="fas fa-clock"></i> Shift
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="shiftFilterDropdown">
                      <li><a class="dropdown-item" href="#" data-shift-filter="all">Semua Shift</a></li>
                      <li><a class="dropdown-item" href="#" data-shift-filter="morning">Shift Pagi</a></li>
                      <li><a class="dropdown-item" href="#" data-shift-filter="afternoon">Shift Sore</a></li>
                    </ul>
                  </div>
                  <div class="dropdown me-2">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="statusFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="fas fa-filter"></i> Status
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="statusFilterDropdown">
                      <li><a class="dropdown-item" href="#" data-status-filter="all">Semua Status</a></li>
                      <li><a class="dropdown-item" href="#" data-status-filter="ontime">Tepat Waktu</a></li>
                      <li><a class="dropdown-item" href="#" data-status-filter="late">Terlambat</a></li>
                    </ul>
                  </div>
                  <!-- <button class="btn btn-sm btn-outline-primary" id="exportAttendance">
                    <i class="fas fa-download"></i> Export
                  </button> -->
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover" id="attendanceTable">
                    <thead>
                      <tr>
                        <th>ID Karyawan</th>
                        <th>Nama</th>
                        <th>Tipe</th>
                        <th>Shift</th>
                        <th>Waktu Masuk</th>
                        <th>Status Masuk</th>
                        <th>Waktu Pulang</th>
                        <th>Durasi Kerja</th>
                        <th>Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="attendanceList">
                      <!-- Data will be populated by JavaScript -->
                    </tbody>
                  </table>
                </div>
                <div class="empty-state" id="emptyAttendance">
                  <img src="img/empty-data.svg" alt="No Data" class="empty-image">
                  <p>Belum ada data kehadiran hari ini</p>
                </div>
              </div>
            </div>

            <!-- Leave List -->
            <div class="card leave-card">
              <div class="card-header">
                <h2><i class="fas fa-calendar-alt"></i> Daftar Izin Karyawan</h2>
                
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover" id="leaveTable">
                    <thead>
                      <tr>
                        <th>ID Karyawan</th>
                        <th>Nama</th>
                        <th>Tipe</th>
                        <th>Shift</th>
                        <th>Tanggal Izin</th>
                        <th>Alasan</th>
                        <th>Jenis Pengganti</th>
                        <th>Detail Pengganti</th>
                        <th>Status Pengajuan</th>
                        <th>Status Ganti</th>
                      </tr>
                    </thead>
                    <tbody id="leaveList">
                      <!-- Data will be populated by JavaScript -->
                    </tbody>
                  </table>
                </div>
                <div class="empty-state" id="emptyLeave">
                  <img src="img/empty-leave.svg" alt="No Leave Data" class="empty-image">
                  <p>Belum ada data izin</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Add Leave Modal -->
    <div class="modal fade" id="addLeaveModal" tabindex="-1" aria-labelledby="addLeaveModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addLeaveModalLabel">Tambah Data Izin</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="addLeaveForm">
              <div class="mb-3">
                <label for="leaveEmployeeId" class="form-label">ID Karyawan</label>
                <select class="form-select" id="leaveEmployeeId" required>
                  <option value="" selected disabled>Pilih Karyawan</option>
                  <!-- Options will be populated by JavaScript -->
                </select>
              </div>
              <div class="mb-3">
                <label for="leaveEmployeeType" class="form-label">Tipe Karyawan</label>
                <select class="form-select" id="leaveEmployeeType" required>
                  <option value="" selected disabled>Pilih Tipe</option>
                  <option value="staff">Staff</option>
                  <option value="ob">Office Boy</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="leaveShift" class="form-label">Shift</label>
                <select class="form-select" id="leaveShift" required>
                  <option value="" selected disabled>Pilih Shift</option>
                  <option value="morning">Shift Pagi</option>
                  <option value="afternoon">Shift Sore</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="leaveDate" class="form-label">Tanggal Izin</label>
                <input type="date" class="form-control" id="leaveDate" required>
              </div>
              <div class="mb-3">
                <label for="leaveReason" class="form-label">Alasan</label>
                <textarea class="form-control" id="leaveReason" rows="3" required></textarea>
              </div>
              <div class="mb-3">
                <label for="leaveReplacementType" class="form-label">Jenis Pengganti</label>
                <select class="form-select" id="leaveReplacementType" required>
                  <option value="" selected disabled>Pilih Jenis Pengganti</option>
                  <option value="libur">Ganti Libur</option>
                  <option value="jam">Ganti Jam</option>
                </select>
              </div>
              <div id="replacementLiburFields" class="replacement-fields" style="display: none;">
                <div class="mb-3">
                  <label for="replacementDate" class="form-label">Tanggal Ganti Libur</label>
                  <input type="date" class="form-control" id="replacementDate">
                </div>
              </div>
              <div id="replacementJamFields" class="replacement-fields" style="display: none;">
                <div class="mb-3">
                  <label for="replacementHourDate" class="form-label">Tanggal Ganti Jam</label>
                  <input type="date" class="form-control" id="replacementHourDate">
                </div>
                <div class="mb-3">
                  <label for="replacementHours" class="form-label">Jumlah Jam</label>
                  <input type="number" class="form-control" id="replacementHours" min="1" max="12">
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="btn btn-primary" id="submitLeaveBtn">Simpan</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Change Shift Modal -->
    <div class="modal fade" id="changeShiftModal" tabindex="-1" aria-labelledby="changeShiftModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="changeShiftModalLabel">Ubah Shift Karyawan</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="changeShiftForm">
              <input type="hidden" id="changeShiftEmployeeId">
              <div class="mb-3">
                <label for="employeeInfo" class="form-label">Karyawan</label>
                <div id="employeeInfo" class="form-control-plaintext"></div>
              </div>
              <div class="mb-3">
                <label for="employeeTypeInfo" class="form-label">Tipe Karyawan</label>
                <div id="employeeTypeInfo" class="form-control-plaintext"></div>
              </div>
              <div class="mb-3">
                <label for="currentShift" class="form-label">Shift Saat Ini</label>
                <div id="currentShift" class="form-control-plaintext"></div>
              </div>
              <div class="mb-3">
                <label for="newShift" class="form-label">Shift Baru</label>
                <select class="form-select" id="newShift" required>
                  <option value="" selected disabled>Pilih Shift Baru</option>
                  <option value="morning">Shift Pagi</option>
                  <option value="afternoon">Shift Sore</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="shiftChangeReason" class="form-label">Alasan Perubahan</label>
                <textarea class="form-control" id="shiftChangeReason" rows="2" required></textarea>
              </div>
              <div class="mb-3">
                <label for="shiftChangeDate" class="form-label">Tanggal Mulai Berlaku</label>
                <input type="date" class="form-control" id="shiftChangeDate" required>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="btn btn-primary" id="submitShiftChangeBtn">Simpan Perubahan</button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="js/melati.js"></script>
    <script type="module" src="js/sistem-absensi.js"></script>
  </body>
</html>

